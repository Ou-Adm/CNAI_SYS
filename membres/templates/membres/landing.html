<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CNAI - Welcome</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background-color: #000;
            font-family: 'Courier New', Courier, monospace;
        }

        /* --- LOADER (Pour ne plus avoir l'écran noir vide) --- */
        #loader {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #667eea;
            font-size: 1.2rem;
            font-weight: bold;
            letter-spacing: 2px;
            z-index: 20;
            animation: pulse 1.5s infinite;
        }
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.3; }
            100% { opacity: 1; }
        }

        /* Le conteneur 3D */
        #canvas-container {
            width: 100vw;
            height: 100vh;
            display: block;
            position: absolute;
            top: 0;
            left: 0;
            z-index: 1;
            opacity: 0; /* Caché au début */
            transition: opacity 1s ease; /* Apparition douce */
        }

        /* L'interface par dessus la 3D */
        .ui-layer {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
            z-index: 10;
            color: white;
            pointer-events: none;
            /* Caché tant que le chargement n'est pas fini */
            display: none; 
        }

        h1 {
            font-size: 5rem;
            font-weight: 800;
            margin: 0;
            letter-spacing: 10px;
            text-transform: uppercase;
            background: linear-gradient(to right, #fff, #667eea);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            /* Animation plus rapide */
            animation: slideUp 1s ease-out forwards;
        }

        p {
            font-size: 1.2rem;
            letter-spacing: 4px;
            color: #a0aec0;
            margin-top: 10px;
            opacity: 0;
            animation: fadeIn 1s ease-out forwards 0.5s;
        }

        /* Le bouton Entrer */
        .enter-btn {
            pointer-events: auto;
            margin-top: 50px;
            padding: 15px 40px;
            background: transparent;
            border: 1px solid rgba(102, 126, 234, 0.5);
            color: #667eea;
            font-size: 1rem;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 2px;
            cursor: pointer;
            border-radius: 30px;
            transition: all 0.3s ease;
            opacity: 0;
            animation: fadeIn 1s ease-out forwards 1s;
            position: relative;
            overflow: hidden;
        }

        .enter-btn:hover {
            background: #667eea;
            color: white;
            box-shadow: 0 0 30px rgba(102, 126, 234, 0.6);
            transform: scale(1.05);
        }

        @keyframes fadeIn { to { opacity: 1; } }
        @keyframes slideUp { 
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Écran de transition blanc */
        .transition-overlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: white;
            z-index: 999;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.8s ease;
        }

        /* Mobile Responsive */
        @media (max-width: 768px) {
            h1 { font-size: 2.5rem; letter-spacing: 5px; }
            p { font-size: 0.9rem; }
        }
    </style>
</head>
<body>

    <div id="loader">INITIALISATION DU SYSTÈME...</div>

    <div id="canvas-container"></div>

    <div class="ui-layer" id="ui-layer">
        <h1>CNAI</h1>
        <p>INTELLIGENCE IS THE FUTURE</p>
        <button class="enter-btn" onclick="enterSite()">ENTRER DANS LE SYSTÈME</button>
    </div>

    <div class="transition-overlay" id="overlay"></div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>

    <script>
        // --- GESTION DU CHARGEMENT ---
        function onSceneReady() {
            // Cacher le loader
            document.getElementById('loader').style.display = 'none';
            // Afficher le canvas avec un fondu
            document.getElementById('canvas-container').style.opacity = '1';
            // Afficher l'interface
            document.getElementById('ui-layer').style.display = 'block';
        }

        // --- 1. CONFIGURATION THREE.JS ---
        const container = document.getElementById('canvas-container');
        const scene = new THREE.Scene();
        
        // Caméra
        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.z = 30;

        // Rendu
        const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(window.devicePixelRatio);
        container.appendChild(renderer.domElement);

        // --- 2. CRÉATION DES OBJETS ---

        // A. Le "Noyau"
        const geometry = new THREE.IcosahedronGeometry(10, 1);
        const material = new THREE.MeshBasicMaterial({ 
            color: 0x667eea, 
            wireframe: true,
            transparent: true,
            opacity: 0.3
        });
        const core = new THREE.Mesh(geometry, material);
        scene.add(core);

        // B. Le "Noyau Interne"
        const innerGeo = new THREE.IcosahedronGeometry(4, 0);
        const innerMat = new THREE.MeshBasicMaterial({ color: 0xffffff, wireframe: true });
        const innerCore = new THREE.Mesh(innerGeo, innerMat);
        scene.add(innerCore);

        // C. Particules
        const particlesGeometry = new THREE.BufferGeometry();
        const particlesCount = 1500;
        const posArray = new Float32Array(particlesCount * 3);

        for(let i = 0; i < particlesCount * 3; i++) {
            posArray[i] = (Math.random() - 0.5) * 100;
        }

        particlesGeometry.setAttribute('position', new THREE.BufferAttribute(posArray, 3));
        const particlesMaterial = new THREE.PointsMaterial({
            size: 0.15,
            color: 0xffffff,
            transparent: true,
            opacity: 0.8,
        });
        const particlesMesh = new THREE.Points(particlesGeometry, particlesMaterial);
        scene.add(particlesMesh);

        // --- 3. INTERACTION SOURIS ---
        let mouseX = 0;
        let mouseY = 0;

        document.addEventListener('mousemove', (event) => {
            mouseX = event.clientX - window.innerWidth / 2;
            mouseY = event.clientY - window.innerHeight / 2;
        });

        // --- 4. ANIMATION LOOP ---
        const clock = new THREE.Clock();
        let firstFrame = true;

        function animate() {
            requestAnimationFrame(animate);

            // Déclencher l'affichage de la page dès la première frame rendue
            if (firstFrame) {
                onSceneReady();
                firstFrame = false;
            }

            const elapsedTime = clock.getElapsedTime();

            core.rotation.y += 0.002;
            core.rotation.x += 0.001;
            
            innerCore.rotation.y -= 0.005;
            innerCore.rotation.x -= 0.005;

            particlesMesh.rotation.y = elapsedTime * 0.05;

            core.rotation.y += mouseX * 0.00005;
            core.rotation.x += mouseY * 0.00005;

            particlesMesh.rotation.x = mouseY * 0.00002;
            particlesMesh.rotation.y = mouseX * 0.00002;

            renderer.render(scene, camera);
        }

        animate();

        // --- 5. REDIMENSIONNEMENT ---
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });

        // --- 6. TRANSITION DE SORTIE ---
        function enterSite() {
            const overlay = document.getElementById('overlay');
            
            // Animation de zoom rapide
            let zoomSpeed = 0.5;
            function zoomIn() {
                camera.position.z -= zoomSpeed;
                zoomSpeed += 0.5;
                core.rotation.y += 0.1;
                renderer.render(scene, camera);
                
                if (camera.position.z > -10) {
                    requestAnimationFrame(zoomIn);
                }
            }
            zoomIn();

            // Fondu au blanc
            overlay.style.opacity = '1';
            
            setTimeout(() => {
                // Redirection vers la page principale
                window.location.href = "{% url 'index' %}";
            }, 800);
        }
    </script>
</body>
</html>